{% extends "base.html" %}
{% load static %}
{% block dependencies %}
<!-- Select2 including Bootstrap4 Theme -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@ttskch/select2-bootstrap4-theme@1.4.0/dist/select2-bootstrap4.min.css" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/i18n/de.js"></script>

<!-- Stylesheet for Formalidation. Can be migrated into basestyles.css -->
<link rel="stylesheet" href="{% static 'upload/formvalidation.css' %}" />

<!-- CKeditor5 -->
<script src="{% static 'upload/ckeditor5/build/ckeditor.js' %}"></script>

<!-- Tooltipster Plugin -->
<script src="{% static 'base/vendor/tooltipster/dist/js/tooltipster.bundle.js' %}"></script>
<link rel="stylesheet" href="{% static 'base/vendor/tooltipster/dist/css/tooltipster.bundle.css' %}" />
<link rel="stylesheet" href="{% static 'base/vendor/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css' %}" />
{% endblock dependencies %}

{% block content %}
<form action="{% url 'main:document_add' %}" method="post" id="documentTitleForm" dep-ref-url="{% url 'ajax_load_refnumbers' %}" modal-inst-url="{% url 'main:institution_add' %}" modal-ref-url="{% url 'refnumber_add' %}" class="needs-validation" novalidate>
    {% csrf_token %}
    {{ form.non_field_errors }}
    <div class="card">
        <div class="card-header" data-toggle="collapse" href="#requiredFields">
            <a class="card-link">
                Pflichtfelder
            </a>
        </div>
        <div id="requiredFields" class="collapse show">
            <div class="card-body">
                <div class="fieldWrapper form-group row">
                    {{ form.title_name.errors }}
                    <div class="col-sm-3">
                        <label for="{{ form.title_name.id_for_label }}" class="control-label">
                            {{ form.title_name.label }}
                        </label>
                        <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_title_name"></i>
                    </div>
                    <div class="col-sm-9">
                        {{ form.title_name }}
                        <span class="error"></span>
                    </div>
                </div>
                <div class="fieldWrapper form-group row">
                    {{ form.parent_institution.errors }}
                    <div class="col-sm-3">
                        <label for="{{ form.parent_institution.id_for_label }}" class="control-label">
                            {{ form.parent_institution.label }}
                        </label>
                        <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_parent_institution"></i>
                    </div>
                    <div class="col-sm-9">
                        {{ form.parent_institution }}
                        <span class="error"></span>
                    </div>
                </div>
                <div class="fieldWrapper form-group row">
                    {{ form.parent_refnumber.errors }}
                    <div class="col-sm-3">
                        <label for="{{ form.parent_refnumber.id_for_label }}" class="control-label">
                            {{ form.parent_refnumber.label }}
                        </label>
                        <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_parent_refnumber"></i>
                    </div>
                    <div class="col-sm-9">
                        {{ form.parent_refnumber }}
                        <span class="error"></span>
                    </div>
                </div>
                <div class="fieldWrapper form-group row">
                    {{ form.transcription_scope.errors }}
                    <div class="col-sm-3">
                        <label for="{{ form.transcription_scope.id_for_label }}" class="control-label">
                            {{ form.transcription_scope.label }}
                        </label>
                        <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_transcription_scope"></i>
                    </div>
                    <div class="col-sm-9">
                        {{ form.transcription_scope }}
                        <span class="error"></span>
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-sm-3">
                        <label for="{{ form.start_year.id_for_label }}" class="control-label" id="labelStartDate">
                            Datierung
                        </label>
                        <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_date"></i>
                    </div>
                    <div class="fieldWrapper col-sm">
                        {{ form.start_year.errors }}
                        {{ form.start_year }}
                        <span class="error"></span>
                    </div>
                    <div class="fieldWrapper col-sm">
                        {{ form.start_month.errors }}
                        {{ form.start_month }}
                        <span class="error"></span>
                    </div>
                    <div class="fieldWrapper col-sm">
                        {{ form.start_day.errors }}
                        {{ form.start_day }}
                        <span class="error"></span>
                    </div> <!-- ToDo: Validation, Widgets, jQuery for Enddate. Also: Where to put fieldWrapper? -->
                </div>
                <div class="form-group row" id="endDate" style="display:none">
                    <div class="col-sm-3">
                        <label for="{{ form.end_year.id_for_label }}" class="control-label">
                            bis
                        </label>
                    </div>
                    <div class="fieldWrapper col-sm">
                        {{ form.end_year.errors }}
                        {{ form.end_year }}
                        <span class="error"></span>
                    </div>
                    <div class="fieldWrapper col-sm">
                        {{ form.end_month.errors }}
                        {{ form.end_month }}
                        <span class="error"></span>
                    </div>
                    <div class="fieldWrapper col-sm">
                        {{ form.end_day.errors }}
                        {{ form.end_day }}
                        <span class="error"></span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm">
                        <button type="button" class="btn btn-light float-right mt-0 mb-3" id="buttonEndDate">Zeitspanne</button>
                    </div>
                </div>
                <div class="fieldWrapper form-group row">
                    {{ form.place_name.errors }}
                    <div class="col-sm-3">
                        <label for="{{ form.place_name.id_for_label }}" class="control-label">
                            {{ form.place_name.label }}
                        </label>
                        <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_place_name"></i>
                    </div>
                    <div class="col-sm-9">
                        {{ form.place_name }}
                        <span class="error"></span>
                    </div>
                </div>
                <div class="fieldWrapper form-group row">
                    {{ form.source_type_parent.errors }}
                    {{ form.source_type_child.errors }}
                    <div class="col-sm-3">
                        <label for="{{ form.source_type_parent.id_for_label }}" class="control-label">
                            {{ form.source_type_parent.label }}
                        </label>
                        <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_source_type"></i>
                    </div>
                    <div class="col-sm-9">
                        {{ form.source_type_parent }}
                        <span class="error"></span>
                    </div>
                </div>
                <div class="row justify-content-end">
                    <div class="col-sm-9">
                        {{ form.source_type_child }}
                        <span class="error"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card">
        <div class="card-header" data-toggle="collapse" href="#transcript">
            <a class="card-link">
                Transkription
            </a>
        </div>
        <div id="transcript" class="collapse show">
            <div class="card-body">
                <div class="fieldWrapper form-group">
                    <div class="row">
                        {{ form.transcription_text.errors }}
                        <div class="col-sm text-left font-weight-bold">
                            <label for="{{ form.transcription_text.id_for_label }}" class="control-label">
                                {{ form.transcription_text.label }}
                            </label>
                            <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_transcription_text"></i>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm">
                            {{ form.transcription_text }}
                            <span class="error"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card">
        <div class="card-header" data-toggle="collapse" href="#textualMetadata">
            <a class="card-link">
                Inhaltliche Metadaten
            </a>
        </div>
        <div id="textualMetadata" class="collapse">
            <div class="card-body">
                <div class="fieldWrapper form-group row">
                    {{ form.author.errors }}
                    <div class="col-sm-3">
                        <label for="{{ form.author.id_for_label }}" class="control-label">
                            {{ form.author.label }}
                        </label>
                        <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_author"></i>
                    </div>
                    <div class="col-sm-9">
                        {{ form.author }}
                        <span class="error"></span>
                    </div>
                </div>
                <div class="fieldWrapper form-group row">
                    {{ form.language.errors }}
                    <div class="col-sm-3">
                        <label for="{{ form.language.id_for_label }}" class="control-label">
                            {{ form.language.label }}
                        </label>
                        <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_language"></i>
                    </div>
                    <div class="col-sm-9">
                        {{ form.language }}
                        <span class="error"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card">
        <div class="card-header" data-toggle="collapse" href="#manuscriptMetadata">
            <a class="card-link">
                Manuskriptbeschreibung
            </a>
        </div>
        <div id="manuscriptMetadata" class="collapse">
            <div class="card-body">
                <div class="fieldWrapper form-group row">
                    {{ form.material.errors }}
                    <div class="col-sm-3">
                        <label for="{{ form.material.id_for_label }}" class="control-label">
                            {{ form.material.label }}
                        </label>
                        <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_material"></i>
                    </div>
                    <div class="col-sm-9">
                        {{ form.material }}
                        <span class="error"></span>
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-sm-3">
                        <label for="{{ form.measurements_length.id_for_label }}" class="control-label">
                            Abmessungen
                        </label>
                        <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_measurements"></i>
                    </div>
                    <div class="fieldWrapper col-sm mb-0">
                        {{ form.measurements_length.errors }}
                        {{ form.measurements_length }}
                        <span class="error"></span>
                    </div>
                    <div class="fieldWrapper col-sm mb-0">
                        {{ form.measurements_width.errors }}
                        {{ form.measurements_width }}
                        <span class="error"></span>
                    </div> <!-- ToDo: Validation, Widgets. Also: Where to put fieldWrapper? -->
                </div>
                <div class="fieldWrapper form-group row">
                    {{ form.pages.errors }}
                    <div class="col-sm-3">
                        <label for="{{ form.pages.id_for_label }}" class="control-label">
                            {{ form.pages.label }}
                        </label>
                        <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_pages"></i>
                    </div>
                    <div class="col-sm-9">
                        {{ form.pages }}
                        <span class="error"></span>
                    </div>
                </div>
                <div class="fieldWrapper form-group row">
                    {{ form.paging_system.errors }}
                    <div class="col-sm-3">
                        <label for="{{ form.paging_system.id_for_label }}" class="control-label">
                            {{ form.paging_system.label }}
                        </label>
                        <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_paging_system"></i>
                    </div>
                    <div class="col-sm-9">
                        {{ form.paging_system }}
                        <span class="error"></span>
                    </div>
                </div>
                <div class="fieldWrapper form-group row">
                    {{ form.illuminated.errors }}
                    <div class="col-sm-3">
                        <label for="{{ form.illuminated.id_for_label }}" class="control-label">
                            {{ form.illuminated.label }}
                        </label>
                        <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_illuminated"></i>
                    </div>
                    <div class="col-sm-9">
                        {{ form.illuminated }}
                        <span class="error"></span>
                    </div>
                </div>
                <div class="fieldWrapper form-group row">
                    {{ form.seal.errors }}
                    <div class="col-sm-3">
                        <label for="{{ form.seal.id_for_label }}" class="control-label">
                            {{ form.seal.label }}
                        </label>
                        <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_seal"></i>
                    </div>
                    <div class="col-sm-9">
                        {{ form.seal }}
                        <span class="error"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card">
        <div class="card-header" data-toggle="collapse" href="#miscMetadata">
            <a class="card-link">
                Kommentare und Links
            </a>
        </div>
        <div id="miscMetadata" class="collapse">
            <div class="card-body">
                <div class="fieldWrapper form-group row">
                    {{ form.comments.errors }}
                    <div class="col-sm-3">
                        <label for="{{ form.comments.id_for_label }}" class="control-label">
                            {{ form.comments.label }}
                        </label>
                        <i class="fas fa-info-circle tooltipster" data-tooltip-content="#tt_comments"></i>
                    </div>
                    <div class="col-sm-9">
                        {{ form.comments }}
                        <span class="error"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row justify-content-center">
        <div class="fieldWrapper form-check col-sm text-right" title="{{ form.submitted_by_anonymous.help_text }}">
            <label for="{{ form.submitted_by_anonymous.id_for_label }}" class="form-check-label tooltipster" data-tooltip-content="#tt_anonymous">
                {{ form.submitted_by_anonymous.label }}
            </label>
        </div>
        <div class="col-sm text-left">
            {{ form.submitted_by_anonymous }}
        </div>
    </div>
    <button type="button" class="btn btn-secondary" id="submitButtonDocument">Absenden</button> <!-- Does this still work with a different value? -->
</form>


<!-- Define institutionModal. Does the modal div need to be in this file? -->
<div class="modal fade" id="institutionModal" tabindex="-1" role="dialog" aria-labelledby="institutionModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">

        </div>
    </div>
</div>

<!-- Define refNumberModal. Does the modal div need to be in this file? -->
<div class="modal fade" id="refNumberModal" tabindex="-1" role="dialog" aria-labelledby="refNumberModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        </div>
    </div>
</div>

<!-- Define confirmationModal-->
<div class="modal fade" id="confirmationModal" tabindex="-1" role="dialog" aria-labelledby="confirmationModalLabel" aria-hidden="true" data-backdrop="static">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="confirmationModalLabel">Bitte überprüfen Sie Ihre Angaben</h5>
            </div>
            <div class="modal-body" style="display: block">
                <div class="col-sm">
                    <div class="row">
                        <h5 id="confirmationModalIntro">
                            Folgende von Ihnen angegebenen Personen sind noch nicht in unserer Datenbank. Möchten Sie diese zur Datenbank hinzufügen?
                        </h5>
                    </div>
                </div>
                <div class="col-sm">
                    <ul id="authorList">

                    </ul>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="submitButtonAuthor">Bestätigen</button>
                <button type="button" class="btn btn-light" id="closeButtonAuthor">Abbrechen</button>
            </div>
        </div>
    </div>
</div>

<div class="container" id="smallnote">
    <p>
        Die mit einem Stern markierten Felder sind Pflichtfelder.
    </p>
</div>

{% include "upload/tooltips.html" %}


{% endblock content %}

{% block javascript %}
<script src="{% static 'upload/uploadscripts.js' %}" charset="utf-8"></script>
{% endblock javascript %}
